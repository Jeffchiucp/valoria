/* So this is how we load valoria.
This is it. We're fetching all the things
in the dimension and using their
idea code to bring them to the dimension.*/

let gun = Gun([`${window.location.href}gun`])

let valoriaGun = gun.get('dimension').get('valoria');

//Create Valoria Element
let valoria = document.createElement('div');
valoria.classList.add('valoria');
valoria.tabIndex = 1;
$(valoria).css({
  width : "100%",
  height : "100%",
  position : "absolute",
  display : "flex",
  justifyContent : "center",
  alignItems : "center",
  zIndex : 0,
  background : "url('https://i.imgur.com/TbwEvfU.png')",
  backgroundColor : "#000000"
})
$('body').append(valoria);

//Get User
let thisUsername = $('#username').text();

axios.get('/dimension/valoria').then((dimensionRes) => {
  let things = dimensionRes.data.things;
  let dimension = dimensionRes.data;
  things.forEach((thingKey) => {
    axios.get('/dimension/valoria/thing/' + thingKey).then((thingRes) => {
      let thingKind = thingRes.data.kind;
      let thingContent = JSON.parse(thingRes.data.content);
      axios.get('/dimension/valoria/idea/' + thingKind).then((ideaRes) => {
        let ideaData = ideaRes.data;
        let ideaContent = ideaRes.data.content;
        eval(ideaContent);
      })
    })
  })
})
